{% extends "boilerplate.html" %}
{% block title %}Reset Password{% endblock %}
{% block content %}
<div class="card mx-auto p-4 shadow" style="max-width:400px;background:#fff8f0;">
    <h4 class="text-center mb-3">Reset Password</h4>
    <p class="text-muted text-center">Enter your new password.</p>

    {% if error %}<div class="alert alert-danger">{{error}}</div>{% endif %}
    {% if success %}<div class="alert alert-success">{{success}}</div>{% endif %}

    <form method="post" action="/reset-password">
        <input type="hidden" name="access_token" id="access_token">
        <input type="hidden" name="refresh_token" id="refresh_token">
        <input type="password" name="password" class="form-control mb-3" placeholder="New password" required>
        <button type="submit" class="btn btn-success w-100">Update Password</button>
    </form>
    <p class="mt-3 text-center"><a href="/login">‚Üê Back to Login</a></p>
</div>

<script>
    // Extract tokens from Supabase hash fragment
    const params = new URLSearchParams(window.location.hash.substring(1));
    const access = params.get("access_token");
    const refresh = params.get("refresh_token");
    if (access && refresh) {
        document.getElementById("access_token").value = access;
        document.getElementById("refresh_token").value = refresh;
    }
</script>
{% endblock %}